---
import Layout from "../layouts/Layout.astro";
import Header from "../components/common/Header.astro";
import Footer from "../components/common/Footer.astro";
import { Phone, Mail, MapPin } from "lucide-astro";
---

<Layout title="Contact">
    <Header />
    <main>
        <section class="bg-gray-50 pt-32 pb-20">
            <div class="container mx-auto px-4 max-w-4xl">
                <div class="text-center mb-12">
                    <h1
                        class="font-heading font-extrabold text-4xl mb-4 text-navy"
                    >
                        Neem contact op
                    </h1>
                    <p class="text-xl text-gray-600">
                        Heb je een specifieke vraag of wil je liever persoonlijk
                        contact?
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Contact Form -->
                    <div class="bg-white p-8 rounded-2xl shadow-sm">
                        <h2 class="font-heading font-bold text-2xl mb-6 text-navy">
                            Stuur ons een bericht
                        </h2>
                        <form id="contact-form" class="space-y-4">
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div>
                                    <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">
                                        Voornaam *
                                    </label>
                                    <input
                                        type="text"
                                        id="firstName"
                                        name="firstName"
                                        required
                                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                                    />
                                </div>
                                <div>
                                    <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">
                                        Achternaam *
                                    </label>
                                    <input
                                        type="text"
                                        id="lastName"
                                        name="lastName"
                                        required
                                        class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                                    />
                                </div>
                            </div>

                            <div>
                                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">
                                    E-mailadres *
                                </label>
                                <input
                                    type="email"
                                    id="email"
                                    name="email"
                                    required
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                                />
                            </div>

                            <div>
                                <label for="phone" class="block text-sm font-medium text-gray-700 mb-1">
                                    Telefoonnummer
                                </label>
                                <input
                                    type="tel"
                                    id="phone"
                                    name="phone"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                                />
                            </div>

                            <div>
                                <label for="city" class="block text-sm font-medium text-gray-700 mb-1">
                                    Woonplaats
                                </label>
                                <input
                                    type="text"
                                    id="city"
                                    name="city"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent"
                                />
                            </div>

                            <div>
                                <label for="message" class="block text-sm font-medium text-gray-700 mb-1">
                                    Bericht *
                                </label>
                                <textarea
                                    id="message"
                                    name="message"
                                    required
                                    rows="5"
                                    class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary focus:border-transparent resize-none"
                                ></textarea>
                            </div>

                            <div id="form-error" class="hidden bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm"></div>
                            <div id="form-success" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-lg text-sm"></div>

                            <button
                                type="submit"
                                id="submit-btn"
                                class="w-full bg-primary hover:bg-primary/90 text-white font-bold py-3 px-6 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed"
                            >
                                Verstuur bericht
                            </button>
                        </form>
                    </div>

                    <div class="space-y-8">
                        <!-- Contact Card -->
                        <div class="bg-white p-8 rounded-2xl shadow-sm">
                            <h2 class="font-heading font-bold text-xl mb-6 text-navy">
                                Contactgegevens
                            </h2>
                            <ul class="space-y-4 text-gray-600">
                                <li class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-primary">
                                        <Phone class="w-5 h-5" />
                                    </div>
                                    <a href="tel:0623545276" class="font-bold hover:text-primary">
                                        06 23545276
                                    </a>
                                </li>
                                <li class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-primary">
                                        <Mail class="w-5 h-5" />
                                    </div>
                                    <a href="mailto:info@johnsglazenwassersbedrijf.nl" class="hover:text-primary">
                                        info@johnsglazenwassersbedrijf.nl
                                    </a>
                                </li>
                                <li class="flex items-center gap-4">
                                    <div class="w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-primary">
                                        <MapPin class="w-5 h-5" />
                                    </div>
                                    <span>Betuwe & Omgeving</span>
                                </li>
                            </ul>
                        </div>

                        <!-- Direct Action Card -->
                        <div class="bg-primary text-white p-8 rounded-2xl shadow-lg relative overflow-hidden">
                            <div class="relative z-10">
                                <h2 class="font-heading font-bold text-xl mb-4">
                                    Direct een prijs?
                                </h2>
                                <p class="mb-6 opacity-90">
                                    Je hoeft niet te wachten. Gebruik onze configurator om direct een indicatie te krijgen.
                                </p>
                                <a
                                    href="/offerte"
                                    class="bg-white text-primary font-bold py-3 px-6 rounded-lg inline-block hover:bg-gray-100 transition-colors"
                                >
                                    Ga naar de configurator
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
</Layout>
<Footer />

<script is:inline>
    document.addEventListener('DOMContentLoaded', function() {
        const form = document.getElementById('contact-form');
        const submitBtn = document.getElementById('submit-btn');
        const errorDiv = document.getElementById('form-error');
        const successDiv = document.getElementById('form-success');

        form.addEventListener('submit', async function(e) {
            e.preventDefault();

            // Reset messages
            errorDiv.classList.add('hidden');
            successDiv.classList.add('hidden');

            // Disable button
            submitBtn.disabled = true;
            submitBtn.textContent = 'Verzenden...';

            const data = {
                firstName: document.getElementById('firstName').value,
                lastName: document.getElementById('lastName').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value || '',
                city: document.getElementById('city').value || '',
                message: document.getElementById('message').value
            };

            try {
                const response = await fetch('/api/contact', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (response.ok) {
                    successDiv.textContent = 'Bedankt voor je bericht! Je ontvangt een bevestiging per e-mail.';
                    successDiv.classList.remove('hidden');
                    form.reset();
                } else {
                    errorDiv.textContent = result.error || 'Er ging iets mis. Probeer het opnieuw.';
                    errorDiv.classList.remove('hidden');
                }
            } catch (error) {
                errorDiv.textContent = 'Er ging iets mis. Probeer het opnieuw.';
                errorDiv.classList.remove('hidden');
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Verstuur bericht';
            }
        });
    });
</script>
